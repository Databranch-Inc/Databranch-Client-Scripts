<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Start-EventLogCollection ‚Äî Operator How-To | Databranch</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&display=swap');

  :root {
    --navy:       #0f1e35;
    --navy-mid:   #1a3154;
    --navy-light: #1e4a7a;
    --accent:     #2e8bff;
    --accent-dim: #1a5fbd;
    --teal:       #00c9b1;
    --white:      #f4f7fb;
    --text:       #d0dce8;
    --text-muted: #8a9bb5;
    --text-dim:   #5a6f8a;
    --border:     #1e3a5a;
    --border-mid: #2a4f72;
    --code-bg:    #0a1624;
    --row-alt:    #0d1e30;
    --success-bg: #0a2418;
    --success-border: #1a6640;
    --warn-bg:    #1e1a08;
    --warn-border:#7a6010;
    --note-bg:    #0a1a2e;
    --note-border:#1a4a7a;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'IBM Plex Sans', sans-serif;
    background: var(--navy);
    color: var(--text);
    font-size: 15px;
    line-height: 1.7;
    -webkit-font-smoothing: antialiased;
  }

  /* ‚îÄ‚îÄ Print styles ‚îÄ‚îÄ */
  @media print {
    body { background: #fff; color: #111; font-size: 12px; }
    .cover { background: #0f1e35 !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
    .sidebar { display: none; }
    .main { margin-left: 0; }
    .page-break { page-break-before: always; }
    a { color: inherit; text-decoration: none; }
  }

  /* ‚îÄ‚îÄ Layout ‚îÄ‚îÄ */
  .layout { display: flex; min-height: 100vh; }

  .sidebar {
    width: 260px;
    min-width: 260px;
    background: #080f1a;
    border-right: 1px solid var(--border);
    position: fixed;
    top: 0; left: 0; bottom: 0;
    overflow-y: auto;
    z-index: 100;
    padding: 0 0 40px 0;
  }

  .sidebar-logo {
    padding: 24px 20px 20px;
    border-bottom: 1px solid var(--border);
    margin-bottom: 12px;
  }
  .sidebar-logo .company { font-size: 11px; font-weight: 600; letter-spacing: 0.15em; color: var(--teal); text-transform: uppercase; margin-bottom: 4px; }
  .sidebar-logo .doc-title { font-size: 13px; font-weight: 500; color: var(--white); line-height: 1.4; }
  .sidebar-logo .doc-sub { font-size: 11px; color: var(--text-muted); margin-top: 2px; }

  .sidebar nav { padding: 0 8px; }
  .nav-section { font-size: 10px; font-weight: 700; letter-spacing: 0.12em; text-transform: uppercase; color: var(--text-dim); padding: 12px 12px 4px; }
  .nav-link { display: block; padding: 6px 12px; border-radius: 5px; font-size: 13px; color: var(--text-muted); text-decoration: none; transition: all 0.15s; line-height: 1.4; }
  .nav-link:hover { background: var(--navy-mid); color: var(--white); }
  .nav-link.active { background: var(--navy-light); color: var(--white); border-left: 2px solid var(--accent); padding-left: 10px; }
  .nav-link.sub { padding-left: 24px; font-size: 12px; }

  .main {
    margin-left: 260px;
    flex: 1;
    min-width: 0;
  }

  /* ‚îÄ‚îÄ Cover ‚îÄ‚îÄ */
  .cover {
    background: linear-gradient(145deg, #0a1828 0%, #0f2544 40%, #0a1e3a 100%);
    padding: 80px 80px 60px;
    border-bottom: 1px solid var(--border);
    position: relative;
    overflow: hidden;
  }
  .cover::before {
    content: '';
    position: absolute;
    top: -80px; right: -80px;
    width: 400px; height: 400px;
    background: radial-gradient(circle, rgba(46,139,255,0.08) 0%, transparent 70%);
    border-radius: 50%;
  }
  .cover::after {
    content: '';
    position: absolute;
    bottom: -40px; left: 100px;
    width: 300px; height: 300px;
    background: radial-gradient(circle, rgba(0,201,177,0.05) 0%, transparent 70%);
    border-radius: 50%;
  }
  .cover-eyebrow { font-size: 11px; font-weight: 600; letter-spacing: 0.2em; text-transform: uppercase; color: var(--teal); margin-bottom: 16px; }
  .cover-title { font-size: 42px; font-weight: 700; color: var(--white); line-height: 1.1; margin-bottom: 10px; letter-spacing: -0.02em; }
  .cover-script { font-family: 'IBM Plex Mono', monospace; font-size: 16px; color: var(--accent); margin-bottom: 8px; }
  .cover-type { font-size: 15px; color: var(--text-muted); font-weight: 300; font-style: italic; margin-bottom: 40px; }
  .cover-meta { display: flex; gap: 40px; flex-wrap: wrap; position: relative; z-index: 1; }
  .cover-meta-item { }
  .cover-meta-label { font-size: 10px; font-weight: 600; letter-spacing: 0.12em; text-transform: uppercase; color: var(--text-dim); margin-bottom: 3px; }
  .cover-meta-value { font-size: 14px; color: var(--text); font-weight: 500; }
  .cover-meta-value.mono { font-family: 'IBM Plex Mono', monospace; color: var(--accent); }

  /* ‚îÄ‚îÄ Content ‚îÄ‚îÄ */
  .content { max-width: 860px; padding: 56px 80px 80px; }

  /* ‚îÄ‚îÄ Sections ‚îÄ‚îÄ */
  .section { margin-bottom: 56px; animation: fadeIn 0.4s ease both; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

  h1 {
    font-size: 26px; font-weight: 700; color: var(--white);
    padding-bottom: 10px;
    border-bottom: 2px solid var(--navy-light);
    margin-bottom: 20px; margin-top: 0;
    letter-spacing: -0.01em;
  }
  h1::before {
    content: '//  ';
    color: var(--accent);
    font-family: 'IBM Plex Mono', monospace;
    font-size: 18px;
    font-weight: 400;
  }
  h2 {
    font-size: 18px; font-weight: 600; color: var(--accent);
    margin: 28px 0 12px; letter-spacing: -0.01em;
  }
  h3 {
    font-size: 15px; font-weight: 600; color: var(--teal);
    margin: 20px 0 8px; text-transform: uppercase; letter-spacing: 0.06em; font-size: 12px;
  }

  p { margin-bottom: 14px; color: var(--text); }

  /* ‚îÄ‚îÄ Code blocks ‚îÄ‚îÄ */
  .code-block {
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-left: 3px solid var(--accent);
    border-radius: 6px;
    padding: 14px 18px;
    margin: 12px 0 20px;
    overflow-x: auto;
  }
  .code-block code {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 13px;
    color: #7dd3fc;
    white-space: pre;
    line-height: 1.6;
  }
  code.inline {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 12.5px;
    background: var(--code-bg);
    color: #7dd3fc;
    padding: 2px 7px;
    border-radius: 4px;
    border: 1px solid var(--border);
  }

  /* ‚îÄ‚îÄ Tables ‚îÄ‚îÄ */
  .table-wrap { overflow-x: auto; margin: 16px 0 24px; border-radius: 8px; border: 1px solid var(--border); }
  table { width: 100%; border-collapse: collapse; font-size: 13.5px; }
  thead tr { background: var(--navy-mid); }
  thead th {
    padding: 11px 16px; text-align: left;
    font-size: 11px; font-weight: 700; letter-spacing: 0.1em;
    text-transform: uppercase; color: var(--text-muted);
    border-bottom: 1px solid var(--border-mid);
  }
  tbody tr { border-bottom: 1px solid var(--border); transition: background 0.1s; }
  tbody tr:last-child { border-bottom: none; }
  tbody tr:nth-child(even) { background: var(--row-alt); }
  tbody tr:hover { background: var(--navy-mid); }
  td { padding: 10px 16px; color: var(--text); vertical-align: top; line-height: 1.5; }
  td.mono { font-family: 'IBM Plex Mono', monospace; font-size: 12.5px; color: #7dd3fc; }
  td strong { color: var(--white); font-weight: 600; }

  /* ‚îÄ‚îÄ Callout boxes ‚îÄ‚îÄ */
  .callout {
    border-radius: 6px;
    padding: 14px 18px;
    margin: 16px 0;
    display: flex;
    gap: 12px;
    align-items: flex-start;
  }
  .callout-icon { font-size: 16px; flex-shrink: 0; margin-top: 1px; }
  .callout-body { flex: 1; }
  .callout-label { font-size: 11px; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; margin-bottom: 4px; }
  .callout-text { font-size: 13.5px; line-height: 1.6; }
  .callout.note   { background: var(--note-bg);    border: 1px solid var(--note-border);   border-left: 3px solid var(--accent); }
  .callout.note   .callout-label { color: var(--accent); }
  .callout.tip    { background: var(--success-bg); border: 1px solid var(--success-border); border-left: 3px solid #22c55e; }
  .callout.tip    .callout-label { color: #22c55e; }
  .callout.warn   { background: var(--warn-bg);    border: 1px solid var(--warn-border);   border-left: 3px solid #eab308; }
  .callout.warn   .callout-label { color: #eab308; }

  /* ‚îÄ‚îÄ Lists ‚îÄ‚îÄ */
  ul.styled { list-style: none; padding: 0; margin: 8px 0 16px; }
  ul.styled li {
    padding: 5px 0 5px 22px;
    position: relative;
    color: var(--text);
    font-size: 14px;
    line-height: 1.6;
  }
  ul.styled li::before {
    content: '‚ñ∏';
    position: absolute; left: 0;
    color: var(--accent); font-size: 11px; top: 7px;
  }

  ol.styled { list-style: none; counter-reset: steps; padding: 0; margin: 8px 0 16px; }
  ol.styled li {
    counter-increment: steps;
    padding: 8px 0 8px 40px;
    position: relative;
    border-bottom: 1px solid var(--border);
    font-size: 14px;
    line-height: 1.6;
  }
  ol.styled li:last-child { border-bottom: none; }
  ol.styled li::before {
    content: counter(steps);
    position: absolute; left: 0;
    width: 26px; height: 26px;
    background: var(--navy-light);
    color: var(--accent);
    font-family: 'IBM Plex Mono', monospace;
    font-size: 12px; font-weight: 600;
    display: flex; align-items: center; justify-content: center;
    border-radius: 50%;
    top: 8px;
  }

  /* ‚îÄ‚îÄ Step blocks ‚îÄ‚îÄ */
  .step-block {
    border: 1px solid var(--border);
    border-radius: 8px;
    margin: 20px 0;
    overflow: hidden;
  }
  .step-header {
    background: var(--navy-mid);
    padding: 12px 20px;
    display: flex;
    align-items: center;
    gap: 12px;
    border-bottom: 1px solid var(--border);
  }
  .step-num {
    width: 28px; height: 28px;
    background: var(--accent);
    color: var(--navy);
    font-family: 'IBM Plex Mono', monospace;
    font-size: 13px; font-weight: 700;
    display: flex; align-items: center; justify-content: center;
    border-radius: 50%;
    flex-shrink: 0;
  }
  .step-title { font-size: 14px; font-weight: 600; color: var(--white); }
  .step-body { padding: 16px 20px; }

  /* ‚îÄ‚îÄ Badge ‚îÄ‚îÄ */
  .badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 600;
    font-family: 'IBM Plex Mono', monospace;
    letter-spacing: 0.05em;
  }
  .badge-blue  { background: rgba(46,139,255,0.15); color: var(--accent); border: 1px solid rgba(46,139,255,0.3); }
  .badge-teal  { background: rgba(0,201,177,0.12); color: var(--teal); border: 1px solid rgba(0,201,177,0.25); }
  .badge-green { background: rgba(34,197,94,0.12); color: #22c55e; border: 1px solid rgba(34,197,94,0.25); }
  .badge-amber { background: rgba(234,179,8,0.12); color: #eab308; border: 1px solid rgba(234,179,8,0.25); }
  .badge-red   { background: rgba(239,68,68,0.12); color: #ef4444; border: 1px solid rgba(239,68,68,0.25); }

  /* ‚îÄ‚îÄ Mode cards ‚îÄ‚îÄ */
  .mode-cards { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin: 20px 0; }
  .mode-card {
    background: var(--code-bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 20px;
    transition: border-color 0.2s;
  }
  .mode-card:hover { border-color: var(--accent); }
  .mode-card-title { font-size: 13px; font-weight: 700; color: var(--white); margin-bottom: 6px; display: flex; align-items: center; gap: 8px; }
  .mode-card-desc  { font-size: 13px; color: var(--text-muted); line-height: 1.5; }

  /* ‚îÄ‚îÄ Prefix legend ‚îÄ‚îÄ */
  .prefix-row { display: flex; align-items: baseline; gap: 12px; padding: 8px 0; border-bottom: 1px solid var(--border); }
  .prefix-row:last-child { border-bottom: none; }
  .prefix-tag { font-family: 'IBM Plex Mono', monospace; font-size: 12px; font-weight: 600; min-width: 90px; }

  /* ‚îÄ‚îÄ Exit code pills ‚îÄ‚îÄ */
  .exit-codes { display: flex; gap: 12px; margin: 16px 0; flex-wrap: wrap; }
  .exit-pill {
    display: flex; align-items: center; gap: 10px;
    background: var(--code-bg); border: 1px solid var(--border);
    border-radius: 8px; padding: 12px 16px;
  }
  .exit-num { font-family: 'IBM Plex Mono', monospace; font-size: 24px; font-weight: 700; }
  .exit-info .exit-label { font-size: 12px; font-weight: 600; margin-bottom: 2px; }
  .exit-info .exit-desc  { font-size: 12px; color: var(--text-muted); }

  /* ‚îÄ‚îÄ Footer ‚îÄ‚îÄ */
  .doc-footer {
    border-top: 1px solid var(--border);
    padding: 24px 80px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: var(--text-dim);
    font-size: 12px;
    max-width: 860px;
  }
  .doc-footer .version { font-family: 'IBM Plex Mono', monospace; color: var(--text-muted); }
</style>
</head>
<body>

<div class="layout">

  <!-- ‚îÄ‚îÄ Sidebar ‚îÄ‚îÄ -->
  <aside class="sidebar">
    <div class="sidebar-logo">
      <div class="company">Databranch</div>
      <div class="doc-title">Start-EventLogCollection</div>
      <div class="doc-sub">Operator How-To Guide</div>
    </div>
    <nav>
      <div class="nav-section">Contents</div>
      <a class="nav-link" href="#overview">Overview</a>
      <a class="nav-link" href="#what-it-does">What the Script Does</a>
      <a class="nav-link" href="#prerequisites">Prerequisites</a>
      <a class="nav-link sub" href="#permissions">Permissions</a>
      <a class="nav-link sub" href="#software">Software Requirements</a>
      <a class="nav-link" href="#running">Running the Script</a>
      <a class="nav-link sub" href="#automated-mode">Automated Mode</a>
      <a class="nav-link sub" href="#custom-mode">Custom Mode</a>
      <a class="nav-link sub" href="#parameters">Common Parameters</a>
      <a class="nav-link" href="#output">Reading the Output</a>
      <a class="nav-link sub" href="#csv-columns">CSV Columns</a>
      <a class="nav-link sub" href="#summary-file">Summary File</a>
      <a class="nav-link" href="#console">Console Output</a>
      <a class="nav-link" href="#troubleshooting">Troubleshooting</a>
      <a class="nav-link" href="#dattormm">DattoRMM Usage</a>
    </nav>
  </aside>

  <!-- ‚îÄ‚îÄ Main ‚îÄ‚îÄ -->
  <div class="main">

    <!-- Cover -->
    <div class="cover">
      <div class="cover-eyebrow">Databranch Script Library</div>
      <div class="cover-title">Event Log Collection</div>
      <div class="cover-script">Start-EventLogCollection.ps1</div>
      <div class="cover-type">Operator How-To Guide</div>
      <div class="cover-meta">
        <div class="cover-meta-item">
          <div class="cover-meta-label">Version</div>
          <div class="cover-meta-value mono">v1.0.1.0</div>
        </div>
        <div class="cover-meta-item">
          <div class="cover-meta-label">Date</div>
          <div class="cover-meta-value">February 20, 2026</div>
        </div>
        <div class="cover-meta-item">
          <div class="cover-meta-label">Author</div>
          <div class="cover-meta-value">Josh Britton / Sam Kirsch</div>
        </div>
        <div class="cover-meta-item">
          <div class="cover-meta-label">Company</div>
          <div class="cover-meta-value">Databranch</div>
        </div>
        <div class="cover-meta-item">
          <div class="cover-meta-label">Audience</div>
          <div class="cover-meta-value">Engineers / Operators</div>
        </div>
      </div>
    </div>

    <div class="content">

      <!-- Overview -->
      <div class="section" id="overview">
        <h1>Overview</h1>
        <p>
          <code class="inline">Start-EventLogCollection.ps1</code> is a PowerShell script that collects Windows Event Log entries
          from one or more servers and saves them as CSV files for review. It supports two operating modes ‚Äî
          <strong>Automated</strong> and <strong>Custom</strong> ‚Äî and is designed to run from the primary
          domain controller or any domain-joined machine with appropriate administrative rights.
        </p>
        <div class="callout note">
          <div class="callout-icon">üë§</div>
          <div class="callout-body">
            <div class="callout-label">Who should run this script?</div>
            <div class="callout-text">Engineers performing server maintenance, inventory, or incident investigation.
              Domain Admin rights or equivalent delegated permissions are required.</div>
          </div>
        </div>
      </div>

      <!-- What it does -->
      <div class="section" id="what-it-does">
        <h1>What the Script Does</h1>
        <p>Each time the script runs it:</p>
        <ul class="styled">
          <li>Discovers all Windows Server machines on the domain (<strong>Automated</strong> mode) or targets a list you provide (<strong>Custom</strong> mode)</li>
          <li>Tests connectivity to each server before attempting collection</li>
          <li>Collects <span class="badge badge-red">Critical</span> and <span class="badge badge-amber">Error</span> events from the <strong>Application</strong> and <strong>System</strong> Event Logs for the past 30 days</li>
          <li>Saves one CSV file per server per log to a timestamped folder under <code class="inline">C:\Databranch</code></li>
          <li>Writes a run summary showing which servers succeeded, failed, or were skipped</li>
        </ul>
      </div>

      <!-- Prerequisites -->
      <div class="section" id="prerequisites">
        <h1>Prerequisites</h1>

        <h2 id="permissions">Permissions</h2>
        <p>The account running the script must have:</p>
        <ul class="styled">
          <li>Domain Admin rights or equivalent delegated access to read remote Event Logs</li>
          <li>Read access to Active Directory (for Automated mode server discovery)</li>
          <li>Network access to target servers on WinRM (port 5985/5986) and/or RPC/CIM ports</li>
        </ul>

        <h2 id="software">Software Requirements</h2>
        <div class="table-wrap">
          <table>
            <thead><tr><th>Requirement</th><th>Details</th></tr></thead>
            <tbody>
              <tr><td class="mono">PowerShell 5.1+</td><td>Primary target. PS 7+ automatically uses faster parallel processing.</td></tr>
              <tr><td class="mono">ActiveDirectory Module</td><td>Required for Automated mode AD discovery. Pre-installed on domain controllers. Install via RSAT on workstations.</td></tr>
              <tr><td class="mono">Network Connectivity</td><td>WinRM and/or CIM/RPC ports open between the script host and all target servers.</td></tr>
              <tr><td class="mono">C:\Databranch</td><td>Output root. Must exist or the account must have rights to create it.</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Running the Script -->
      <div class="section" id="running">
        <h1>Running the Script</h1>

        <div class="step-block">
          <div class="step-header">
            <div class="step-num">1</div>
            <div class="step-title">Open PowerShell as Administrator</div>
          </div>
          <div class="step-body">
            <p>Right-click <strong>Windows PowerShell</strong> or <strong>PowerShell 7</strong> and select <em>Run as Administrator</em>. Using a Domain Admin account is strongly recommended.</p>
          </div>
        </div>

        <div class="step-block">
          <div class="step-header">
            <div class="step-num">2</div>
            <div class="step-title">Navigate to the Script Location</div>
          </div>
          <div class="step-body">
            <div class="code-block"><code>cd C:\Databranch</code></div>
          </div>
        </div>

        <div class="step-block">
          <div class="step-header">
            <div class="step-num">3</div>
            <div class="step-title">Choose Your Mode and Run</div>
          </div>
          <div class="step-body">
            <div class="mode-cards">
              <div class="mode-card">
                <div class="mode-card-title"><span class="badge badge-blue">Automated</span> Recommended</div>
                <div class="mode-card-desc">Discovers all Windows Server machines on the domain automatically. Best for routine collection.</div>
              </div>
              <div class="mode-card">
                <div class="mode-card-title"><span class="badge badge-teal">Custom</span> Targeted</div>
                <div class="mode-card-desc">You specify exactly which servers to target by name, FQDN, or IP. No discovery step.</div>
              </div>
            </div>

            <h3 id="automated-mode">Automated Mode</h3>
            <p>Just run the script with no parameters ‚Äî Automated is the default:</p>
            <div class="code-block"><code>.\Start-EventLogCollection.ps1</code></div>
            <p>Or explicitly:</p>
            <div class="code-block"><code>.\Start-EventLogCollection.ps1 -Mode Automated</code></div>

            <h3 id="custom-mode">Custom Mode</h3>
            <p>Pass a comma-separated list of server names, FQDNs, or IP addresses:</p>
            <div class="code-block"><code>.\Start-EventLogCollection.ps1 -Mode Custom -ComputerName "DC01","FileServer02","AppServer01"</code></div>
            <p>You can mix hostnames, FQDNs, and IPs:</p>
            <div class="code-block"><code>.\Start-EventLogCollection.ps1 -Mode Custom -ComputerName "DC01","app01.domain.local","192.168.1.50"</code></div>
          </div>
        </div>

        <h2 id="parameters">Common Optional Parameters</h2>
        <div class="table-wrap">
          <table>
            <thead><tr><th>Parameter</th><th>What It Does</th></tr></thead>
            <tbody>
              <tr><td class="mono">-DaysBack 14</td><td>Collect events from the past 14 days instead of the default 30.</td></tr>
              <tr><td class="mono">-OutputPath D:\Logs</td><td>Save output to a different root folder instead of <code class="inline">C:\Databranch</code>.</td></tr>
              <tr><td class="mono">-LogNames Application</td><td>Only collect from the Application log instead of both Application and System.</td></tr>
              <tr><td class="mono">-Subnets "10.0.1.0/24"</td><td>Override auto-detected subnets for the ping sweep fallback in Automated mode.</td></tr>
            </tbody>
          </table>
        </div>
        <p>Example ‚Äî collect only the last 7 days from two specific servers:</p>
        <div class="code-block"><code>.\Start-EventLogCollection.ps1 -Mode Custom -ComputerName "DC01","FS01" -DaysBack 7</code></div>
      </div>

      <!-- Output -->
      <div class="section" id="output">
        <h1>Reading the Output</h1>

        <h2>Where Files Are Saved</h2>
        <p>Every run creates a new timestamped subfolder under <code class="inline">C:\Databranch</code> so runs never overwrite each other:</p>
        <div class="code-block"><code>C:\Databranch\2026-02-20_21-28-17\
‚îú‚îÄ‚îÄ JME-DC1 Application Event Log.csv
‚îú‚îÄ‚îÄ JME-DC1 System Event Log.csv
‚îú‚îÄ‚îÄ JME-APP1 Application Event Log.csv
‚îú‚îÄ‚îÄ JME-APP1 System Event Log.csv
‚îî‚îÄ‚îÄ EventLog-Collection-Summary-2026-02-20_21-28-17.txt</code></div>

        <h2 id="csv-columns">CSV File Contents</h2>
        <div class="table-wrap">
          <table>
            <thead><tr><th>Column</th><th>Description</th></tr></thead>
            <tbody>
              <tr><td class="mono">Server</td><td>The name of the server the event was collected from.</td></tr>
              <tr><td class="mono">LogName</td><td>The Event Log the event came from (Application or System).</td></tr>
              <tr><td class="mono">Level</td><td>The severity level: <span class="badge badge-red">Critical</span> or <span class="badge badge-amber">Error</span>.</td></tr>
              <tr><td class="mono">EventId</td><td>The Windows Event ID number.</td></tr>
              <tr><td class="mono">Source</td><td>The application or Windows component that generated the event.</td></tr>
              <tr><td class="mono">TimeCreated</td><td>Date and time the event occurred.</td></tr>
              <tr><td class="mono">Message</td><td>The full event description text.</td></tr>
            </tbody>
          </table>
        </div>

        <h2 id="summary-file">Reading the Summary File</h2>
        <p>The summary file gives a quick overview of the run. Open it in Notepad or any text editor. It shows how many servers were discovered, how many passed connectivity checks, how many CSVs were written successfully, and a list of any servers that failed or were skipped with error details.</p>
      </div>

      <!-- Console Output -->
      <div class="section" id="console">
        <h1>Console Output</h1>
        <p>The script writes status messages to the console as it runs. Here is what each prefix means:</p>
        <div style="border: 1px solid var(--border); border-radius: 8px; padding: 4px 0; margin: 16px 0;">
          <div class="prefix-row" style="padding: 10px 20px;">
            <div class="prefix-tag" style="color:#60a5fa;">[INFO]</div>
            <div style="font-size:13.5px;">Normal progress update ‚Äî something is happening as expected.</div>
          </div>
          <div class="prefix-row" style="padding: 10px 20px; background: var(--row-alt);">
            <div class="prefix-tag" style="color:#22c55e;">[SUCCESS]</div>
            <div style="font-size:13.5px;">A step completed successfully ‚Äî a file was written, a server is reachable, etc.</div>
          </div>
          <div class="prefix-row" style="padding: 10px 20px;">
            <div class="prefix-tag" style="color:#eab308;">[WARN]</div>
            <div style="font-size:13.5px;">Something unexpected happened but the script is continuing ‚Äî a server is unreachable, a file could not be deleted, etc.</div>
          </div>
          <div class="prefix-row" style="padding: 10px 20px; background: var(--row-alt);">
            <div class="prefix-tag" style="color:#ef4444;">[ERROR]</div>
            <div style="font-size:13.5px;">A specific collection task failed. The script will continue with remaining servers.</div>
          </div>
          <div class="prefix-row" style="padding: 10px 20px;">
            <div class="prefix-tag" style="color:#a78bfa;">[DEBUG]</div>
            <div style="font-size:13.5px;">Detailed internal information. Safe to ignore during normal operation.</div>
          </div>
        </div>
      </div>

      <!-- Troubleshooting -->
      <div class="section" id="troubleshooting">
        <h1>Troubleshooting</h1>

        <h2>A Server Shows as Unreachable</h2>
        <ul class="styled">
          <li>Confirm the server is powered on and network-accessible from your machine.</li>
          <li>Verify WinRM is enabled on the target: run <code class="inline">Enable-PSRemoting -Force</code> on the target server.</li>
          <li>Check that Windows Firewall allows WinRM (port 5985) and CIM/RPC traffic from your machine.</li>
          <li>Confirm your account has remote management rights on the target.</li>
        </ul>

        <h2>AD Discovery Returns No Servers</h2>
        <p>If the ActiveDirectory module is not available or the AD query fails, the script automatically falls back to a ping sweep of the local subnet. If you see a <code class="inline">[WARN]</code> message about AD, this is expected and the sweep will proceed. If the sweep also finds nothing, check network connectivity or use Custom mode to specify servers manually.</p>

        <h2>CSV is Empty / No Events Found</h2>
        <p>If a server has no Critical or Error events in the collection window, the script logs an <code class="inline">[INFO]</code> message and skips writing that file rather than writing an empty CSV. This is normal ‚Äî it means that server is clean for the selected time period.</p>

        <h2>Script Exits with Code 1</h2>
        <p>Exit code 1 means partial success ‚Äî at least one server collected successfully but one or more failed. Check the summary file and console output for which servers failed and why. This is not a full failure.</p>

        <div class="callout tip">
          <div class="callout-icon">üí°</div>
          <div class="callout-body">
            <div class="callout-label">Tip</div>
            <div class="callout-text">Log files for each script run are saved permanently to
              <code class="inline">C:\Databranch\ScriptLogs\Start-EventLogCollection\</code>.
              If you need to review what happened in a previous run, check the dated log file in that folder.</div>
          </div>
        </div>
      </div>

      <!-- DattoRMM -->
      <div class="section" id="dattormm">
        <h1>Running via DattoRMM</h1>
        <p>The script is fully compatible with DattoRMM component deployment. All parameters can be set as DattoRMM environment variables in the component configuration ‚Äî no script modification needed.</p>

        <div class="table-wrap">
          <table>
            <thead><tr><th>Environment Variable</th><th>Example Value</th><th>Notes</th></tr></thead>
            <tbody>
              <tr><td class="mono">Mode</td><td class="mono">Automated</td><td><code class="inline">Automated</code> or <code class="inline">Custom</code></td></tr>
              <tr><td class="mono">ComputerName</td><td class="mono">DC01,FS01,APP01</td><td>Comma-separated, no spaces. Custom mode only.</td></tr>
              <tr><td class="mono">DaysBack</td><td class="mono">30</td><td>Integer. Default is 30.</td></tr>
              <tr><td class="mono">OutputPath</td><td class="mono">C:\Databranch</td><td>Root output folder. Timestamped subfolder created automatically.</td></tr>
              <tr><td class="mono">LogNames</td><td class="mono">Application,System</td><td>Comma-separated log names.</td></tr>
              <tr><td class="mono">Subnets</td><td class="mono">192.168.1.0/24</td><td>CIDR. Comma-separate for multiple. Optional.</td></tr>
            </tbody>
          </table>
        </div>

        <h2>Exit Codes</h2>
        <div class="exit-codes">
          <div class="exit-pill">
            <div class="exit-num" style="color:#22c55e;">0</div>
            <div class="exit-info">
              <div class="exit-label" style="color:#22c55e;">Success</div>
              <div class="exit-desc">All servers collected successfully</div>
            </div>
          </div>
          <div class="exit-pill">
            <div class="exit-num" style="color:#eab308;">1</div>
            <div class="exit-info">
              <div class="exit-label" style="color:#eab308;">Partial</div>
              <div class="exit-desc">Some servers failed, at least one succeeded</div>
            </div>
          </div>
          <div class="exit-pill">
            <div class="exit-num" style="color:#ef4444;">2</div>
            <div class="exit-info">
              <div class="exit-label" style="color:#ef4444;">Failure</div>
              <div class="exit-desc">Complete failure or fatal exception</div>
            </div>
          </div>
        </div>

        <div class="callout warn">
          <div class="callout-icon">‚ö†Ô∏è</div>
          <div class="callout-body">
            <div class="callout-label">DattoRMM Note</div>
            <div class="callout-text">DattoRMM agents typically run PowerShell 5.1. The script is fully compatible with 5.1 and uses the runspace pool engine in that environment. If PS 7 is installed on the agent machine, it will be used automatically for better performance.</div>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div class="doc-footer">
        <div>Databranch &mdash; Confidential</div>
        <div class="version">Start-EventLogCollection.ps1 &nbsp;|&nbsp; v1.0.1.0 &nbsp;|&nbsp; Feb 2026</div>
      </div>

    </div><!-- /content -->
  </div><!-- /main -->
</div><!-- /layout -->

<script>
  // Highlight active nav link on scroll
  const sections = document.querySelectorAll('.section[id], h2[id], h3[id]');
  const navLinks = document.querySelectorAll('.nav-link');
  const observer = new IntersectionObserver(entries => {
    entries.forEach(e => {
      if (e.isIntersecting) {
        navLinks.forEach(l => l.classList.remove('active'));
        const link = document.querySelector(`.nav-link[href="#${e.target.id}"]`);
        if (link) link.classList.add('active');
      }
    });
  }, { rootMargin: '-20% 0px -70% 0px' });
  sections.forEach(s => observer.observe(s));
</script>
</body>
</html>
